import{$ as i}from"./TranslationUtil-B606p0FM.js";import{_ as O}from"./DialogCloseBtn.vue_vue_type_script_setup_true_lang-C9VfeYnB.js";import{d as R,e as B,h as E,b as T}from"./Http-D0CTbQn3.js";import{u as L}from"./alert-BGDP0mED.js";import{$ as j}from"./api-2IIv40F6.js";import{V as q}from"./VDialog-B0kihmvn.js";import{V as P}from"./VCard-TCpTMKi2.js";import{V as g}from"./VCardText-C48XgJ5F.js";import{d as U,r as $,w as W,g as c,f as d,m as t,aW as z,o as u,l as m,b as f,b8 as F,t as y,v as C,ai as k}from"./index-DZWVFJEj.js";const x=U({__name:"dialog-create-order",props:{order:{type:Object,default:()=>{}}},emits:["done"],setup(w,{emit:S}){const V=w,_=S,A=R(),N=B(),b=$({}),n=$(!1),r=$(!0),p=e=>{e===void 0?n.value=!1:b.value=e,r.value=!1,_("done")},D=e=>{Array.isArray(e.items)&&(e.items=e.items.filter(o=>{var s;return o.options=(s=o.options)==null?void 0:s.filter(a=>"id"in a&&a.id!==void 0&&a.id!==null),"id"in o&&o.id!==void 0&&o.id!==null}))},I=e=>{var a,h;const o=(a=A.getCurrentLocation)==null?void 0:a.id;if(o===void 0){L().setAlert({title:i("page.order.add.section.create.error.locationNotDefined")});return}const s=(h=N.getCurrentCustomerList)==null?void 0:h.id;if(s===void 0){L().setAlert({title:i("page.order.add.section.create.error.customerListNotDefined")});return}r.value=!0,D(e),j("orderpad/order",{method:"POST",body:{locationId:o,customerListId:s,...e},onResponseError({response:l}){E(l),p()}}).then(l=>{p(l.order)}).catch(l=>{T(l),p()})},v=()=>{n.value=!1,r.value=!1,window.location.reload()};return W(()=>V.order,()=>{n.value=!0,r.value=!0,I(V.order)}),(e,o)=>{const s=O;return u(),c(q,{modelValue:t(n),"onUpdate:modelValue":o[0]||(o[0]=a=>z(n)?n.value=a:null),persistent:t(r),class:"v-dialog-sm","onClick:outside":v},{default:d(()=>[t(r)?m("",!0):(u(),c(s,{key:0,onClick:v})),f(P,{color:t(r)?"primary":"white",title:t(r)?("$t"in e?e.$t:t(i))("page.order.add.section.create.creating.title"):("$t"in e?e.$t:t(i))("page.order.add.section.create.created.title")},{default:d(()=>[t(r)?(u(),c(g,{key:0,class:"pt-3 text-white"},{default:d(()=>[f(F,{"bg-color":"rgba(var(--v-theme-surface), 0.1)",class:"mb-0 mt-4",color:"#fff",indeterminate:""})]),_:1})):m("",!0),t(r)?m("",!0):(u(),c(g,{key:1},{default:d(()=>[y(C(("$t"in e?e.$t:t(i))("page.order.add.section.create.created.description",{orderName:t(b).ref})),1)]),_:1})),t(r)?m("",!0):(u(),c(g,{key:2,class:"d-flex justify-end gap-3 flex-wrap"},{default:d(()=>[f(k,{to:{name:"order-list"},color:"secondary",variant:"tonal"},{default:d(()=>[y(C(("$t"in e?e.$t:t(i))("page.order.add.section.create.button.orders")),1)]),_:1}),f(k,{onClick:v},{default:d(()=>[y(C(("$t"in e?e.$t:t(i))("page.order.add.section.create.button.validate")),1)]),_:1})]),_:1}))]),_:1},8,["color","title"])]),_:1},8,["modelValue","persistent"])}}});export{x as _};
