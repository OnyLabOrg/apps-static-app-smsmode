import{$ as u}from"./TranslationUtil-B606p0FM.js";import{d as U,e as q,f as F,h as p,b as L}from"./Http-D0CTbQn3.js";import{$ as f}from"./api-2IIv40F6.js";import{V as $}from"./VSelect-DiptaScs.js";import{d as A,r as g,G as M,c as N,o as b,F as j,g as y,l as V,m as n}from"./index-DZWVFJEj.js";const P=A({__name:"AppSelectContext",props:{enableLocations:{type:Boolean,default:()=>!1},enableCustomerLists:{type:Boolean,default:()=>!1},enableCatalogs:{type:Boolean,default:()=>!1}},setup(D){const h=D,E=g(h.enableLocations),S=g(h.enableCustomerLists),k=g(h.enableCatalogs),l=U(),s=q(),a=F(),i=g(),d=g(),r=g();i.value=l.getCurrentLocation,d.value=s.getCurrentCustomerList,r.value=a.getCurrentCatalog;const m=e=>{var o;typeof e=="string"&&(e=((o=s.getCustomerLists)==null?void 0:o.find(t=>t.id===e))??null),e!==null&&(s.setCurrentCustomerList(e),d.value=s.getCurrentCustomerList)},c=e=>{var o;if(typeof e=="string"&&(e=((o=a.getCatalogs)==null?void 0:o.find(t=>t.id===e))??null),e!==null){if(e.data!==void 0){a.setCurrentCatalog(e),r.value=a.getCurrentCatalog;return}f(`catalog?catalogId=${e.id}`,{method:"GET",onResponseError({response:t}){a.setCurrentCatalog(void 0),p(t)}}).then(t=>{a.setCurrentCatalog(t.catalog),r.value=a.getCurrentCatalog,e.data=t.catalog.data}).catch(t=>{a.setCurrentCatalog(void 0),L(t)})}},R=()=>{var e,o;k.value&&(a.getCatalogs===void 0?(a.setCatalogs(void 0),f(`catalogs?locationId=${(e=l.getCurrentLocation)==null?void 0:e.id}`,{method:"GET",onResponseError({response:t}){p(t)}}).then(t=>{var C;a.setCatalogs(t.catalogs),((C=a.getCatalogs)==null?void 0:C.length)===1&&c(a.getCatalogs[0])}).catch(t=>{L(t)})):a.getCurrentCatalog!==void 0?c(a.getCurrentCatalog):((o=a.getCatalogs)==null?void 0:o.length)===1&&c(a.getCatalogs[0]))},B=()=>{var e,o;S.value&&(s.getCustomerLists===void 0?(s.setCustomerLists(void 0),f(`customers/list?locationId=${(e=l.getCurrentLocation)==null?void 0:e.id}`,{method:"GET",onResponseError({response:t}){p(t)}}).then(t=>{var C;s.setCustomerLists(t.lists),((C=s.getCustomerLists)==null?void 0:C.length)===1&&m(s.getCustomerLists[0])}).catch(t=>{L(t)})):s.getCurrentCustomerList!==void 0?m(s.getCurrentCustomerList):((o=s.getCustomerLists)==null?void 0:o.length)===1&&m(s.getCustomerLists[0]))},v=e=>{var o;typeof e=="string"&&(e=((o=l.getLocations)==null?void 0:o.find(t=>t.id===e))??null),e!==null&&(e!==l.getCurrentLocation?(l.setCurrentLocation(e),i.value=l.getCurrentLocation,T(),w()):(B(),R()))},G=()=>{l.setLocations(void 0),f("locations",{method:"GET",onResponseError({response:e}){p(e)}}).then(e=>{var o;l.setLocations(e.locations),((o=l.getLocations)==null?void 0:o.length)===1&&v(l.getLocations[0])}).catch(e=>{L(e)})},I=()=>{i.value!==void 0&&(i.value=void 0),l.reset(),G()},T=()=>{d.value!==void 0&&(d.value=void 0),s.reset(),B()},w=()=>{r.value!==void 0&&(r.value=void 0),a.reset(),R()};return M(()=>{var e;E.value&&(l.getLocations===void 0?G():l.getCurrentLocation!==void 0?v(l.getCurrentLocation):((e=l.getLocations)==null?void 0:e.length)===1&&v(l.getLocations[0]))}),(e,o)=>(b(),N(j,null,[E.value?(b(),y($,{key:0,modelValue:i.value,"onUpdate:modelValue":[o[0]||(o[0]=t=>i.value=t),v],disabled:n(l).getLocations===void 0,items:n(l).getLocations,label:("$t"in e?e.$t:n(u))("page.order.add.button.location.label"),loading:n(l).getLocations===void 0,placeholder:("$t"in e?e.$t:n(u))("page.order.add.button.location.placeholder"),clearable:"","item-title":"name","item-value":"id","no-data-text":"common.component.noData",style:{width:"200px"},variant:"underlined","onClick:clear":I},null,8,["modelValue","disabled","items","label","loading","placeholder"])):V("",!0),S.value?(b(),y($,{key:1,modelValue:d.value,"onUpdate:modelValue":[o[1]||(o[1]=t=>d.value=t),m],disabled:n(s).getCustomerLists===void 0,items:n(s).getCustomerLists,label:("$t"in e?e.$t:n(u))("page.order.add.button.customerList.label"),loading:n(s).getCustomerLists===void 0,placeholder:("$t"in e?e.$t:n(u))("page.order.add.button.customerList.placeholder"),clearable:"","item-title":"name","item-value":"id","no-data-text":"common.component.noData",style:{width:"200px"},variant:"underlined","onClick:clear":T},null,8,["modelValue","disabled","items","label","loading","placeholder"])):V("",!0),k.value?(b(),y($,{key:2,modelValue:r.value,"onUpdate:modelValue":[o[2]||(o[2]=t=>r.value=t),c],disabled:n(a).getCatalogs===void 0,items:n(a).getCatalogs,label:("$t"in e?e.$t:n(u))("page.order.add.button.catalog.label"),loading:n(a).getCatalogs===void 0,placeholder:("$t"in e?e.$t:n(u))("page.order.add.button.catalog.placeholder"),clearable:"","item-title":"name","item-value":"id","no-data-text":"common.component.noData",style:{width:"200px"},variant:"underlined","onClick:clear":w},null,8,["modelValue","disabled","items","label","loading","placeholder"])):V("",!0)],64))}});export{P as _};
