import{_ as j}from"./AppSelect.vue_vue_type_script_setup_true_lang-CNQQVv21.js";import{_ as X}from"./AppTextField.vue_vue_type_script_setup_true_lang-BPdyjHDB.js";import{c as m}from"./common-api.web.min-CNoIadEv.js";import{d as Z}from"./PriceUtil-BoQYKurK.js";import{u as q,a as J}from"./location-Cc6Lhsvp.js";import{V as v,a as r}from"./VRow-DAX72Tb6.js";import{d as K,r as Q,X as N,G as W,c as D,b as l,e as i,f as s,m as p,ai as O,o as _,t as c,$ as ee,F as te,i as ae,g as T,l as w,v as n}from"./index-DfJhTF3D.js";import{V as le}from"./VCard-AgAH1aFc.js";import{V as se}from"./VCardText-DHi_ViAT.js";import{V as M}from"./VSwitch-Cbs1zzZF.js";import{V as b}from"./VRangeSlider-DSBfooGF.js";const oe={class:"d-flex align-center justify-space-between"},ne={class:"d-flex align-center justify-space-between mb-4"},ie={class:"text-caption mb-1"},re={class:"text-caption mb-1"},de={class:"text-caption mb-1"},me={class:"text-caption mb-1"},ce={class:"text-caption mb-1"},ue={class:"pt-5 text-right"},S=20,x=1e3,g=1e3,U=-60,A=-12,Se=K({__name:"setting-group",emits:["done"],setup(pe,{emit:$}){var E;const I=$,z=((E=q().getCurrentAccount)==null?void 0:E.currency)??m.Api.HubriseCurrencyCode.EUR,P=J(),d=Q([]),G=[{title:"Delivery",value:m.Api.HubriseServiceType.DELIVERY},{title:"Pickup",value:m.Api.HubriseServiceType.COLLECTION},{title:"Eat-In",value:m.Api.HubriseServiceType.EAT_IN}],L=(e="")=>{d.value.length<20&&d.value.push({id:Date.now(),name:e,useZipCodes:!1,zipCodes:"",orderCountRange:[0,S],totalSpentRange:[0,x],loyaltyPointsRange:[0,g],firstOrderDateRange:[U,0],lastOrderDateRange:[A,0],serviceTypes:[m.Api.HubriseServiceType.DELIVERY,m.Api.HubriseServiceType.COLLECTION,m.Api.HubriseServiceType.EAT_IN],smsOptIn:!0})},H=e=>{d.value.length>1&&(d.value=d.value.filter(o=>o.id!==e))},F=(e,o)=>!e||e.trim().length===0?"Group name is required":e.trim()!==e?"Group name cannot have leading or trailing spaces":/^[a-z0-9\-]+$/i.test(e)?d.value.find(f=>f.id!==o&&f.name.toLowerCase()===e.toLowerCase())?"A group with this name already exists":!0:"Only letters, numbers and dashes are allowed",k=N(()=>{const e={};return d.value.forEach(o=>{const u=F(o.name,o.id);u!==!0&&(e[o.id]=u)}),e}),B=N(()=>Object.keys(k.value).length===0),V=e=>e===S?`${e}+`:`${e}`,h=e=>e===g?`${e}+`:`${e}`,y=e=>`${Z(m.Api.HubrisePriceUtil.amountToPrice(e,z))}${e===x?"+":""}`,R=e=>e===0?"Now":`${Math.abs(e)}${e===U?"+":""} month${Math.abs(e)>1?"s":""} ago`,C=e=>e===0?"Now":`${Math.abs(e)}${e===A?"+":""} month${Math.abs(e)>1?"s":""} ago`,Y=()=>{I("done",{})};return W(()=>{var e;L(m.Util.StringUtil.slugify(((e=P.getCurrentLocation)==null?void 0:e.name)??"all"))}),(e,o)=>{const u=X,f=j;return _(),D("div",null,[l(v,null,{default:s(()=>[l(r,{cols:"12"},{default:s(()=>[i("div",oe,[o[1]||(o[1]=i("div",null,[i("h6",{class:"text-h6 font-weight-medium"}," Customer Groups "),i("p",{class:"mb-0"}," Manage your customer groups for smsmode ")],-1)),l(O,{disabled:p(d).length>=10,color:"primary",variant:"tonal",onClick:L},{default:s(()=>[l(ee,{icon:"bx-plus",start:""}),o[0]||(o[0]=c(" Add Group "))]),_:1,__:[0]},8,["disabled"])])]),_:1}),l(r,{cols:"12"},{default:s(()=>[l(v,null,{default:s(()=>[(_(!0),D(te,null,ae(p(d),t=>(_(),T(r,{key:t.id,cols:"12"},{default:s(()=>[l(le,{variant:"outlined"},{default:s(()=>[l(se,null,{default:s(()=>[i("div",ne,[l(u,{modelValue:t.name,"onUpdate:modelValue":a=>t.name=a,"error-messages":p(k)[t.id]||"",density:"compact",label:"Group Name",style:{"max-width":"200px"}},null,8,["modelValue","onUpdate:modelValue","error-messages"]),p(d).length>1?(_(),T(O,{key:0,color:"error",icon:"bx-trash",size:"small",variant:"text",onClick:a=>H(t.id)},null,8,["onClick"])):w("",!0)]),l(v,null,{default:s(()=>[l(r,{class:"d-inline-flex align-items-center justify-space-between gap-4 align-center",cols:"12",md:"7"},{default:s(()=>[l(M,{modelValue:t.useZipCodes,"onUpdate:modelValue":a=>t.useZipCodes=a,class:"d-inline-block align-baseline",density:"compact","hide-details":"",label:"Restrict by zip codes"},null,8,["modelValue","onUpdate:modelValue"]),t.useZipCodes?(_(),T(u,{key:0,modelValue:t.zipCodes,"onUpdate:modelValue":a=>t.zipCodes=a,class:"d-inline-block align-baseline",density:"compact",label:"zip codes (comma separated)",placeholder:"75001,75002,75003"},null,8,["modelValue","onUpdate:modelValue"])):w("",!0)]),_:2},1024),l(r,{cols:"12",md:"5"},{default:s(()=>[l(f,{modelValue:t.serviceTypes,"onUpdate:modelValue":a=>t.serviceTypes=a,items:G,chips:"","closable-chips":"",label:"Select service type",multiple:""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),l(r,{cols:"12",md:"4"},{default:s(()=>[o[2]||(o[2]=i("div",{class:"text-caption"}," Marketing opt-in ",-1)),l(M,{modelValue:t.smsOptIn,"onUpdate:modelValue":a=>t.smsOptIn=a,density:"compact","hide-details":"",label:"SMS marketing"},null,8,["modelValue","onUpdate:modelValue"])]),_:2,__:[2]},1024),l(r,{cols:"12",md:"4"},{default:s(()=>[i("div",ie," Order count: "+n(V(t.orderCountRange[0]))+" - "+n(V(t.orderCountRange[1])),1),l(b,{modelValue:t.orderCountRange,"onUpdate:modelValue":a=>t.orderCountRange=a,max:S,min:0,"thumb-size":18,"tick-size":3,"show-ticks":"",step:"1","thumb-label":""},{"thumb-label":s(({modelValue:a})=>[c(n(V(a)),1)]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1024),l(r,{cols:"12",md:"4"},{default:s(()=>[i("div",re," Total spent: "+n(y(t.totalSpentRange[0]))+" - "+n(y(t.totalSpentRange[1])),1),l(b,{modelValue:t.totalSpentRange,"onUpdate:modelValue":a=>t.totalSpentRange=a,max:x,min:0,"thumb-size":18,step:"1","thumb-label":""},{"thumb-label":s(({modelValue:a})=>[c(n(y(a)),1)]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1024),l(r,{cols:"12",md:"4"},{default:s(()=>[i("div",de," Loyalty points: "+n(h(t.loyaltyPointsRange[0]))+" - "+n(h(t.loyaltyPointsRange[1])),1),l(b,{modelValue:t.loyaltyPointsRange,"onUpdate:modelValue":a=>t.loyaltyPointsRange=a,max:g,min:0,"thumb-size":18,step:"1","thumb-label":""},{"thumb-label":s(({modelValue:a})=>[c(n(h(a)),1)]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1024),l(r,{cols:"12",md:"4"},{default:s(()=>[i("div",me," First order: "+n(R(t.firstOrderDateRange[0]))+" - "+n(R(t.firstOrderDateRange[1])),1),l(b,{modelValue:t.firstOrderDateRange,"onUpdate:modelValue":a=>t.firstOrderDateRange=a,max:0,min:U,"thumb-size":18,step:"1","thumb-label":""},{"thumb-label":s(({modelValue:a})=>[c(n(R(a)),1)]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1024),l(r,{cols:"12",md:"4"},{default:s(()=>[i("div",ce," Last order: "+n(C(t.lastOrderDateRange[0]))+" - "+n(C(t.lastOrderDateRange[1])),1),l(b,{modelValue:t.lastOrderDateRange,"onUpdate:modelValue":a=>t.lastOrderDateRange=a,max:0,min:A,"thumb-size":18,"tick-size":3,"show-ticks":"",step:"1","thumb-label":""},{"thumb-label":s(({modelValue:a})=>[c(n(C(a)),1)]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}),i("div",ue,[l(O,{disabled:!p(B),onClick:Y},{default:s(()=>o[3]||(o[3]=[c(" Save ")])),_:1,__:[3]},8,["disabled"])])])}}});export{Se as _};
