import{r as ee}from"./validators-BJEf8OaU.js";import{w as X,d as j,r as w,g as B,f as h,b as u,l as P,m,ba as Y,t as A,v as F,e as x,b0 as Z,a as ze,$ as C,aW as q,ai as R,c as _,a$ as Le,o as N,F as J,i as te,q as Fe,di as se,dj as Q,x as Ke,bb as Ue}from"./index-BeBG7se5.js";import{_ as ge}from"./AppTextField.vue_vue_type_script_setup_true_lang-BepRHtfL.js";import{_ as Re}from"./AppSelect.vue_vue_type_script_setup_true_lang-BQHnBRv5.js";import{_ as Me}from"./AppDateTimePicker.vue_vue_type_style_index_0_lang-4mLteppy.js";import{_ as He}from"./AppDrawerHeaderSection.vue_vue_type_script_setup_true_lang-h7QSV0Mf.js";import{u as Ze,S as We,P as Xe,U as Ye,E as qe}from"./index-COSlvPW_.js";import{T as Je}from"./index-BGw9wO34.js";import{C as je}from"./vue3-perfect-scrollbar-B-TfroUy.js";import{V as Ge}from"./VNavigationDrawer-CU0Pn0eS.js";import{V as Qe}from"./VDivider-DAIpLJuN.js";import{V as ne}from"./VForm-DGycaF1N.js";import{V as be}from"./VCardText-51u1fWz-.js";import{V as et,a as U}from"./VRow-DcAkoV74.js";import{V as he}from"./VChip-BDq-4ie3.js";import{V as tt}from"./VSelect-PHQB3_T7.js";import{V as ve}from"./VAvatar-Ezomk3Rh.js";import{V as ie}from"./VImg-0KjYhfmJ.js";import{V as De}from"./VTooltip-DT2P1Zrc.js";import{V as nt}from"./VFileInput-DYV86WGR.js";import{_ as at}from"./AppTextarea.vue_vue_type_script_setup_true_lang-Bl6UTo0h.js";import{_ as ot}from"./MoreBtn.vue_vue_type_script_setup_true_lang-D4Cb5xE6.js";import{V as rt}from"./VCard-NIrRrA9M.js";import{V as lt}from"./VSpacer-BOUPZakj.js";import{V as st}from"./VMenu-CeIo03Bj.js";import{V as it}from"./VList-BnZB7mVK.js";import{_ as dt}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as ct}from"./VTextField-SYXXouzY.js";import{u as ut}from"./useApi-CSm7-o2_.js";import{$ as z}from"./api-BEunVx5r.js";import"./helpers-BGv4x_9E.js";import"./VField-CdT2DSY3.js";import"./form-J-oGqMJG.js";import"./easing-Bybner-F.js";import"./VInput-ClLzGKQK.js";import"./transition-BDOC5Uc_.js";import"./delay-t-efVJDY.js";import"./scopeId-B5g1BDC2.js";import"./ssrBoot-Bjtt1dD1.js";import"./forwardRefs-C-GTDzx5.js";/* empty css              */import"./VSlideGroup-JwXo4N0h.js";import"./dialog-transition-NetQuTSg.js";import"./VOverlay-C9gJ4TBz.js";import"./lazy-Cc9O5wjm.js";import"./VCheckboxBtn-CpSTl8MR.js";import"./VSelectionControl-CZNs0_kI.js";import"./index-DuS_zm-5.js";import"./VCounter-DbvhImLE.js";/* empty css                   */import"./index-CvOPxmL5.js";function ft(e,t){var n=!1;return function(...a){n||(e.call(null,...a),n=!0,setTimeout(function(){n=!1},t))}}function ye(e){return e.split(" ").filter(t=>t)}var Ne=typeof window<"u";function M(e,t,n=!1){if(!t)return;const a=ye(t);if(a.length&&!a.includes("longTouch"))for(const o of e){if(!G(o)||!$.has(o)){o.classList.add(...a);continue}const l=[],r=$.get(o);if(r){for(const s of a)o.classList.contains(s)?o.classList.contains(s)&&n===!1&&l.push(s):o.classList.add(s);r.privateClasses=l,$.set(o,r)}}}function ae(e,t){if(!t)return;const n=ye(t);if(n.length)for(const a of e){if(!G(a)){a.classList.remove(...n);continue}const o=$.get(a);if(o)for(const l of n)o.privateClasses.includes(l)||a.classList.remove(l)}}function xe(e){let t=e.parentNode;for(;t!==null&&t.nodeType===1&&t instanceof HTMLElement;){const a=window.getComputedStyle(t).getPropertyValue("overflow");if(a==="scroll"||a==="auto")return t;t=t.parentNode}return document.documentElement}function mt(e){if(!(e.e instanceof TouchEvent))return;const t=e.e.touches[0].clientX,n=e.e.touches[0].clientY;let a=document.elementFromPoint(t,n);if(!G(a))return;let o,l=!0;for(;a&&l;){if($.has(a)||E.has(a)){l=!1,o=E.has(a);break}a=a.parentNode}if(o){const r=E.get(a);return r?{parent:{el:a,data:r}}:void 0}else{const r=$.get(a);if(!r)return;const s=E.get(a.parentNode);return s?{node:{el:a,data:r},parent:{el:a.parentNode,data:s}}:void 0}}function G(e){return e instanceof HTMLElement&&e.parentNode instanceof HTMLElement}function we(e,t){const n=new AbortController;for(const a in t){const o=t[a];e.addEventListener(a,o,{signal:n.signal,passive:!1})}return n}function ke(e,t,n=!1){const a=window.getComputedStyle(e),o=["position","z-index","top","left","x","pointer-events","y","transform-origin","filter","-webkit-text-fill-color"];for(const l of Array.from(a))n===!1&&l&&o.includes(l)||t.style.setProperty(l,a.getPropertyValue(l),a.getPropertyPriority(l));for(const l of Array.from(e.children)){if(!G(l))continue;const r=t.children[Array.from(e.children).indexOf(l)];ke(l,r,n)}}function H(e){return e instanceof DragEvent?{x:e.clientX,y:e.clientY}:{x:e.touches[0].clientX,y:e.touches[0].clientY}}Array();function Te(e={}){const t=[{transform:`translateY(${e.yScale||50}%)`},{transform:`translateY(${e.yScale||0}%)`}],n=[{transform:`translateY(-${e.yScale||50}%)`},{transform:`translateY(${e.yScale||0}%)`}],a=[{transform:`translateX(${e.xScale||50}%)`},{transform:`translateX(${e.xScale||0}%)`}],o=[{transform:`translateX(-${e.xScale||50}%)`},{transform:`translateX(${e.xScale||0}%)`}];return l=>{if(E.get(l))return{setup(){document.head.querySelector("[data-drag-and-drop]")},setupNodeRemap(s){if(!i)return;const d=e.duration||150;if(s.nodeData.value===i.draggedNode.data.value){switch(i.incomingDirection){case"below":O(s.node,t,d);break;case"above":O(s.node,n,d);break;case"left":O(s.node,o,d);break;case"right":O(s.node,a,d);break}return}if(!i.affectedNodes.map(V=>V.data.value).includes(s.nodeData.value))return;const p=s.node.getBoundingClientRect(),c=i.affectedNodes.findIndex(V=>V.data.value===s.nodeData.value),I=i.draggedNode.data.index>=i.targetIndex;let v;if(I?v=i.affectedNodes[c+1]?i.affectedNodes[c+1]:i.affectedNodes[c-1]:v=i.affectedNodes[c-1]?i.affectedNodes[c-1]:i.affectedNodes[c+1],v){const V=Math.abs(p.x-v.el.getBoundingClientRect().x),T=Math.abs(p.y-v.el.getBoundingClientRect().y);V>T&&I?O(s.node,o,d):V>T&&!I&&O(s.node,a,d)}else switch(i.incomingDirection){case"below":O(s.node,n,d);break;case"above":O(s.node,t,d);break;case"left":O(s.node,a,d);break;case"right":O(s.node,o,d);break}}}}}function O(e,t,n){i&&(i.preventEnter=!0,e.animate(t,{duration:n}),setTimeout(()=>{i&&(i.preventEnter=!1)},n))}Array();Array();var me={up:[0,-1],down:[0,1],left:[-1,0],right:[1,0]},$=new WeakMap,E=new WeakMap,i=void 0;function pt(){i=void 0}function Ie(e){return i={ascendingDirection:!1,incomingDirection:void 0,enterCount:0,targetIndex:0,affectedNodes:[],lastValue:void 0,activeNode:void 0,lastTargetValue:void 0,remapJustFinished:!1,preventEnter:!1,clonedDraggedEls:[],originalZIndex:void 0,transferred:!1,...e},i}function gt(e,t){return i={...e,...t},i}function Ve(e){const{x:t,y:n}=H(e.e);return{coordinates:{x:t,y:n},draggedNode:{el:e.targetData.node.el,data:e.targetData.node.data},draggedNodes:[{el:e.targetData.node.el,data:e.targetData.node.data}],initialIndex:e.targetData.node.data.index,initialParent:{el:e.targetData.parent.el,data:e.targetData.parent.data},lastParent:{el:e.targetData.parent.el,data:e.targetData.parent.data},scrollParent:xe(e.targetData.node.el)}}function bt(e,t){const n=Ce(e),o=[...de(t.targetData.parent.el,t.targetData.parent.data).filter(l=>!n.includes(l))];o.splice(t.targetData.node.data.index,0,...n),e.lastTargetValue=t.targetData.node.data.value,ce(t.targetData.parent.el,t.targetData.parent.data,[...o])}function de(e,t){return[...t.getValues(e)]}function ce(e,t,n){t.setValues(n,e)}function Ce(e){return[...e.draggedNodes.map(t=>t.data.value)]}function ht({parent:e,getValues:t,setValues:n,config:a={}}){var r,s,d;if(!Ne)return;document.addEventListener("dragover",p=>{if(p.preventDefault(),!($.has(p.target)||E.has(p.target))&&i){i.remapJustFinished=!1,i.lastTargetValue=void 0;const{x:c,y}=H(p);i.coordinates.y=y,i.coordinates.x=c,oe()}}),vt(e);const o={getValues:t,setValues:n,config:{handleDragstart:xt,handleDragoverNode:Xt,handleDragoverParent:Yt,handleEnd:Ee,handleTouchstart:At,handleTouchmove:zt,handleTouchOverNode:Vt,handleTouchOverParent:qt,handleDragenterNode:jt,handleDragleaveNode:Gt,performSort:bt,performTransfer:Se,root:document,setupNode:Ct,setupNodeRemap:Pe,reapplyDragClasses:_t,tearDownNode:Et,tearDownNodeRemap:Pt,remapFinished:Nt,scrollBehavior:{x:.8,y:.8},threshold:{horizontal:0,vertical:0},...a},enabledNodes:[],abortControllers:{}};new MutationObserver(yt).observe(e,{childList:!0}),E.set(e,o),(r=a.plugins)==null||r.forEach(p=>{var c,y;(y=(c=p(e))==null?void 0:c.tearDown)==null||y.call(c)}),(s=a.plugins)==null||s.forEach(p=>{var c,y;(y=(c=p(e))==null?void 0:c.tearDown)==null||y.call(c)}),(d=a.plugins)==null||d.forEach(p=>{var c,y;(y=(c=p(e))==null?void 0:c.setup)==null||y.call(c)}),Dt(e,o),ue(e,!0)}function vt(e){const t=E.get(e);t&&t.abortControllers.mainParent&&t.abortControllers.mainParent.abort()}function Dt(e,t){t.abortControllers.mainParent=we(e,{dragover:tn(ft(t.config.handleDragoverParent,10)),touchOverParent:t.config.handleTouchOverParent})}function yt(e){const t=e[0].target;t instanceof HTMLElement&&ue(t)}function ue(e,t){const n=E.get(e);if(!n)return;const a=[],o=n.config;for(let s=0;s<e.children.length;s++){const d=e.children[s];if(!G(d))continue;const p=$.get(d);(t||!p)&&o.tearDownNode({node:d,parent:e,nodeData:p,parentData:n}),!o.disabled&&(!o.draggable||o.draggable&&o.draggable(d))&&a.push(d)}if(a.length!==n.getValues(e).length&&!o.disabled){console.warn("The number of enabled nodes does not match the number of values.");return}const l=n.getValues(e),r=[];for(let s=0;s<a.length;s++){const d=a[s],p=$.get(d),c=Object.assign(p??{privateClasses:[],abortControllers:{}},{value:l[s],index:s});if(i&&c.value===i.draggedNode.data.value&&(i.draggedNode.data=c,i.draggedNode.el=d),i&&i.draggedNodes.map(I=>I.data.value).includes(c.value)){const I=i.draggedNodes.find(v=>v.data.value===c.value);I&&(I.el=d)}r.push({el:d,data:c});const y={node:d,parent:e,parentData:n,nodeData:c};(t||!p)&&o.setupNode(y),Pe(y)}E.set(e,{...n,enabledNodes:r}),o.remapFinished(n)}function Nt(){i&&(i.remapJustFinished=!0,i.affectedNodes=[])}function xt(e){e.e instanceof DragEvent&&It({e:e.e,targetData:e.targetData})}function wt(e,t,n){M([e],t),setTimeout(()=>{ae([e],t),M([e],n)})}function kt(e){const t=Ie(Ve(e));return e.e.stopPropagation(),e.e.dataTransfer&&(e.e.dataTransfer.dropEffect="move",e.e.dataTransfer.effectAllowed="move",e.e.dataTransfer.setDragImage(e.targetData.node.el,e.e.offsetX,e.e.offsetY)),t}function _e(e){if(!(e.e instanceof DragEvent)&&!(e.e instanceof TouchEvent))return!1;const t=e.targetData.parent.data.config;if(!t.dragHandle)return!0;const n=e.targetData.node.el.querySelectorAll(t.dragHandle);if(!n)return!1;const a=H(e.e),o=t.root.elementFromPoint(a.x,a.y);if(!o)return!1;for(const l of Array.from(n))if(o===l||l.contains(o))return!0;return!1}function Tt(e){if(!_e(e))return;const t=$t(e);St(e,t),Ot(e,t)}function It(e){if(!_e(e)){e.e.preventDefault();return}const t=e.targetData.parent.data.config,n=kt(e),a=e.targetData.node.el.style.zIndex;n.originalZIndex=a,e.targetData.node.el.style.zIndex="9999",wt(n.draggedNode.el,t.draggingClass,t.dropZoneClass)}function Vt(e){i&&(e.detail.targetData.parent.el===i.lastParent.el?$e(e.detail,i):re(e.detail,i))}function Ct(e){var n;const t=e.parentData.config;e.node.draggable=!0,e.nodeData.abortControllers.mainNode=we(e.node,{dragstart:L(t.handleDragstart),dragover:L(t.handleDragoverNode),dragenter:L(t.handleDragenterNode),dragleave:L(t.handleDragleaveNode),dragend:L(t.handleEnd),touchstart:L(t.handleTouchstart),touchmove:L(t.handleTouchmove),touchend:L(t.handleEnd),touchOverNode:t.handleTouchOverNode}),t.reapplyDragClasses(e.node,e.parentData),(n=e.parentData.config.plugins)==null||n.forEach(a=>{var o,l;(l=(o=a(e.parent))==null?void 0:o.setupNode)==null||l.call(o,e)})}function Pe(e){var t;$.set(e.node,e.nodeData),(t=e.parentData.config.plugins)==null||t.forEach(n=>{var a,o;(o=(a=n(e.parent))==null?void 0:a.setupNodeRemap)==null||o.call(a,e)})}function _t(e,t){if(!i)return;const n="touchedNode"in i?t.config.touchDropZoneClass:t.config.dropZoneClass;i.draggedNode.el===e&&M([e],n,!0)}function Pt(e){var t;(t=e.parentData.config.plugins)==null||t.forEach(n=>{var a,o;(o=(a=n(e.parent))==null?void 0:a.tearDownNodeRemap)==null||o.call(a,e)})}function Et(e){var t,n,a,o,l;(t=e.parentData.config.plugins)==null||t.forEach(r=>{var s,d;(d=(s=r(e.parent))==null?void 0:s.tearDownNode)==null||d.call(s,e)}),e.node.draggable=!1,(a=(n=e.nodeData)==null?void 0:n.abortControllers)!=null&&a.mainNode&&((l=(o=e.nodeData)==null?void 0:o.abortControllers)==null||l.mainNode.abort())}function Ee(e){i&&(Bt(e,i),pt())}function Bt(e,t){var l,r,s,d;document.removeEventListener("contextmenu",Be),"longTouchTimeout"in t&&t.longTouchTimeout&&clearTimeout(t.longTouchTimeout);const n=(l=E.get(t.initialParent.el))==null?void 0:l.config,o="touchedNode"in t?n==null?void 0:n.touchDropZoneClass:n==null?void 0:n.dropZoneClass;t.originalZIndex!==void 0&&(t.draggedNode.el.style.zIndex=t.originalZIndex),M(t.draggedNodes.map(p=>p.el),o,!0),ae(t.draggedNodes.map(p=>p.el),o),n!=null&&n.longTouchClass&&ae(t.draggedNodes.map(p=>p.el),(s=(r=t.initialParent.data)==null?void 0:r.config)==null?void 0:s.longTouchClass),"touchedNode"in t&&((d=t.touchedNode)==null||d.remove())}function At(e){e.e instanceof TouchEvent&&Tt({e:e.e,targetData:e.targetData})}function $t(e){e.e.stopPropagation();const t=e.targetData.node.el.cloneNode(!0),n=e.targetData.node.el.getBoundingClientRect();return gt(Ie(Ve(e)),{coordinates:{x:e.e.touches[0].clientX,y:e.e.touches[0].clientY},scrollParent:xe(e.targetData.node.el),touchStartLeft:e.e.touches[0].clientX-n.left,touchStartTop:e.e.touches[0].clientY-n.top,touchedNode:t,touchMoving:!1})}function Be(e){e.preventDefault()}function St(e,t){t.touchedNodeDisplay=t.touchedNode.style.display;const n=e.targetData.node.el.getBoundingClientRect();t.touchedNode.style.cssText=`
            width: ${n.width}px;
            position: fixed;
            pointer-events: none;
            top: -9999px;
            z-index: 999999;
            display: none;
          `,document.body.append(t.touchedNode),ke(e.targetData.node.el,t.touchedNode),t.touchedNode.style.display="none",document.addEventListener("contextmenu",Be)}function Ot(e,t){const n=e.targetData.parent.data.config;n.longTouch&&(t.longTouchTimeout=setTimeout(()=>{t&&(t.longTouch=!0,n.longTouchClass&&e.e.cancelable&&M(t.draggedNodes.map(a=>a.el),n.longTouchClass),e.e.preventDefault())},n.longTouchTimeout||200))}function zt(e){!i||!("touchedNode"in i)||Wt(e,i)}function Lt(e,t){t.longTouchClass&&ae(e.draggedNodes.map(n=>n.el),t==null?void 0:t.longTouchClass),t.touchDraggingClass&&M([e.touchedNode],t.touchDraggingClass),t.touchDropZoneClass&&M(e.draggedNodes.map(n=>n.el),t.touchDropZoneClass)}function Ft(e){if(!e||!e.scrollParent||e.scrollParent===document.documentElement&&!("touchedNode"in e))return;const{x:t,y:n,width:a,height:o}=e.scrollParent.getBoundingClientRect(),{x:l,y:r,scrollOutside:s}=e.lastParent.data.config.scrollBehavior;return{state:e,xThresh:l,yThresh:r,scrollOutside:s,scrollParent:e.scrollParent,x:t,y:n,width:a,height:o}}function Kt(e){const t=Ft(i);if(t)switch(e){case"down":return Ht(t.state,t);case"up":return Mt(t.state,t);case"right":return Ut(t.state,t);case"left":return Rt(t.state,t)}}function Ut(e,t){const n=t.scrollParent.clientWidth+t.x-e.coordinates.x;if(!(!t.scrollOutside&&n<0)&&n<(1-t.xThresh)*t.scrollParent.clientWidth&&!(t.scrollParent.scrollLeft+t.scrollParent.clientWidth>=t.scrollParent.scrollWidth))return e}function Rt(e,t){const n=t.scrollParent.clientWidth+t.x-e.coordinates.x;if(!(!t.scrollOutside&&n>t.scrollParent.clientWidth)&&n>t.xThresh*t.scrollParent.clientWidth&&t.scrollParent.scrollLeft!==0)return e}function Mt(e,t){const n=t.scrollParent.clientHeight+t.y-e.coordinates.y;if(!(!t.scrollOutside&&n>t.scrollParent.clientHeight)&&n>t.yThresh*t.scrollParent.clientHeight&&t.scrollParent.scrollTop!==0)return e}function Ht(e,t){const n=t.scrollParent.clientHeight+t.y-e.coordinates.y;if(!(!t.scrollOutside&&n<0)&&n<(1-t.yThresh)*t.scrollParent.clientHeight&&!(t.scrollParent.scrollTop+t.scrollParent.clientHeight>=t.scrollParent.scrollHeight))return e}function Zt(e,t){t.touchMoving=!0,t.touchedNode.style.display=t.touchedNodeDisplay||"";const{x:n,y:a}=H(e.e);t.coordinates.y=a,t.coordinates.x=n;const o=t.touchStartLeft??0,l=t.touchStartTop??0;t.touchedNode.style.left=`${n-o}px`,t.touchedNode.style.top=`${a-l}px`,Lt(t,e.targetData.parent.data.config)}function Wt(e,t){if(e.targetData.parent.data.config.longTouch&&!t.longTouch){clearTimeout(t.longTouchTimeout);return}e.e.cancelable&&e.e.preventDefault(),Zt(e,t),oe();const a=mt(e);if(!a)return;const o={e:e.e,targetData:a};"node"in a?a.node.el.dispatchEvent(new CustomEvent("touchOverNode",{detail:o})):a.parent.el.dispatchEvent(new CustomEvent("touchOverParent",{detail:o}))}function oe(){for(const e of Object.keys(me)){const[t,n]=me[e];Ae(e,t,n)}}function Ae(e,t,n){const a=Kt(e);a&&(a.scrollParent.scrollBy(t,n),setTimeout(()=>{Ae(e,t,n)},"touchedNode"in a?10:100))}function Xt(e){if(!i)return;const{x:t,y:n}=H(e.e);i.coordinates.y=n,i.coordinates.x=t,oe(),Qt(e,i)}function Yt(e){if(!i)return;const{x:t,y:n}=H(e.e);i.coordinates.y=n,i.coordinates.x=t,oe(),re(e,i)}function qt(e){i&&re(e.detail,i)}function Jt(e,t){if(e.targetData.parent.el===t.lastParent.el)return!1;const n=e.targetData.parent.data.config;if(n.dropZone===!1)return!1;const a=t.initialParent.data.config;return n.accepts?n.accepts(e.targetData.parent,t.initialParent,t.lastParent,t):!(!n.group||n.group!==a.group)}function jt(e,t){e.e.preventDefault()}function Gt(e,t){e.e.preventDefault()}function Qt(e,t){var n;e.e.preventDefault(),e.e.stopPropagation(),e.targetData.parent.el===((n=t.lastParent)==null?void 0:n.el)?$e(e,t):re(e,t)}function en(e,t,n,a){var c;if(t.affectedNodes.map(y=>y.data.value).includes(e.targetData.node.data.value))return!1;if(t.remapJustFinished)return t.remapJustFinished=!1,(e.targetData.node.data.value===t.lastTargetValue||t.draggedNodes.map(y=>y.el).includes(e.targetData.node.el))&&(t.lastTargetValue=e.targetData.node.data.value),!1;if(t.draggedNodes.map(y=>y.el).includes(e.targetData.node.el))return t.lastTargetValue=void 0,!1;if(e.targetData.node.data.value===t.lastTargetValue||t.preventEnter||e.targetData.parent.el!==((c=t.lastParent)==null?void 0:c.el)||e.targetData.parent.data.config.sortable===!1)return!1;const o=e.targetData.node.el.getBoundingClientRect(),l=t.draggedNode.el.getBoundingClientRect(),r=o.y-l.y,s=o.x-l.x;let d;Math.abs(r)>Math.abs(s)?d=r>0?"above":"below":d=s>0?"left":"right";const p=t.lastParent.data.config.threshold;switch(d){case"left":if(n>o.x+o.width*p.horizontal)return t.incomingDirection="left",!0;break;case"right":if(n<o.x+o.width*(1-p.horizontal))return t.incomingDirection="right",!0;break;case"above":if(a>o.y+o.height*p.vertical)return t.incomingDirection="above",!0;break;case"below":if(a<o.y+o.height*(1-p.vertical))return t.incomingDirection="below",!0;break}return!1}function $e(e,t){const{x:n,y:a}=H(e.e);if(!en(e,t,n,a))return;const o=t.draggedNode.data.index>e.targetData.node.data.index?[e.targetData.node.data.index,t.draggedNode.data.index]:[t.draggedNode.data.index,e.targetData.node.data.index];t.targetIndex=e.targetData.node.data.index,t.affectedNodes=e.targetData.parent.data.enabledNodes.filter(l=>o[0]<=l.data.index&&l.data.index<=o[1]&&l.el!==t.draggedNode.el),e.targetData.parent.data.config.performSort(t,e)}function L(e){function t(n){var r;const a=$.get(n),o=n.parentNode||((r=i==null?void 0:i.lastParent)==null?void 0:r.el);if(!a)return;const l=E.get(o);if(l)return{node:{el:n,data:a},parent:{el:o,data:l}}}return n=>{const a=t(n.currentTarget);if(a)return e({e:n,targetData:a})}}function Se(e,t){const n=Ce(e),a=de(e.lastParent.el,e.lastParent.data).filter(s=>!n.includes(s)),o=de(t.targetData.parent.el,t.targetData.parent.data),l=e.initialParent.el===t.targetData.parent.el&&t.targetData.parent.data.config.sortable===!1;let r;"node"in t.targetData?(l?r=e.initialIndex:t.targetData.parent.data.config.sortable===!1?r=t.targetData.parent.data.enabledNodes.length:r=t.targetData.node.data.index,o.splice(r,0,...n)):(r=l?e.initialIndex:t.targetData.parent.data.enabledNodes.length,o.splice(r,0,...n)),ce(e.lastParent.el,e.lastParent.data,a),ce(t.targetData.parent.el,t.targetData.parent.data,o)}function re(e,t){Jt(e,t)&&(e.targetData.parent.data.config.performTransfer(t,e),t.lastParent=e.targetData.parent,t.transferred=!0)}function tn(e){function t(n){const a=E.get(n);if(a)return{parent:{el:n,data:a}}}return n=>{const a=t(n.currentTarget);if(a)return e({e:n,targetData:a})}}function pe(e){if(e instanceof HTMLElement)return e;if(e.value instanceof HTMLElement)return e.value;if("$el"in e&&e.$el instanceof HTMLElement)return e.$el}function nn(e,t){Array.isArray(e)||(e=[e]);for(const n of e){const a=pe(n);if(a)return t(a);const o=X(n,l=>{if(!l)return;const r=pe(l);r?t(r):console.warn("Invalid parent element",l),o()})}}var fe=new WeakMap;function an(e){const t=fe.get(e);return t?t.value:(console.warn("No values found for parent element"),[])}function on(e,t){const n=fe.get(t);n&&(n.value=e)}function Oe(e){Ne&&(Array.isArray(e)||(e=[e]),e.forEach(t=>{const{parent:n,values:a,...o}=t;nn(n,rn(o,a))}))}function rn(e,t){return n=>{fe.set(n,t),ht({parent:n,getValues:an,setValues:on,config:{...e,dropZones:[]}})}}const ln={class:"border rounded px-3 py-2"},sn={key:0,class:"d-flex justify-end flex-wrap gap-x-2"},dn=j({__name:"KanbanBoardEditDrawer",props:{kanbanItem:{default:()=>({item:{title:"",dueDate:"2022-01-01T00:00:00Z",labels:[],members:[],id:0,attachments:0,commentsCount:0,image:"",comments:""},boardId:0,boardName:""})},isDrawerOpen:{type:Boolean}},emits:["update:isDrawerOpen","update:kanbanItem","deleteKanbanItem"],setup(e,{emit:t}){const n=e,a=t,o=w(),l=["UX","Image","Code Review","Dashboard","Bug"],r=w(JSON.parse(JSON.stringify(n.kanbanItem.item))),s=T=>{var g;a("update:isDrawerOpen",T),T||(g=o.value)==null||g.reset()};X(()=>n.kanbanItem,()=>{r.value=JSON.parse(JSON.stringify(n.kanbanItem.item))},{deep:!0});const d=()=>{var T;(T=o.value)==null||T.validate().then(async g=>{var S;g.valid&&(a("update:kanbanItem",{item:r.value,boardId:n.kanbanItem.boardId,boardName:n.kanbanItem.boardName}),a("update:isDrawerOpen",!1),await Le(),(S=o.value)==null||S.reset())})},p=()=>{a("deleteKanbanItem",{item:r.value,boardId:n.kanbanItem.boardId,boardName:n.kanbanItem.boardName}),a("update:isDrawerOpen",!1)},c=Ze({content:"",extensions:[We,Je.configure({types:["heading","paragraph"]}),Xe.configure({placeholder:"Write a Comment..."}),Ye]}),y=w({altFormat:"M j, Y",altInput:!0,dateFormat:"Y-m-d"}),I={UX:"success",Image:"warning","Code Review":"info",Dashboard:"primary",Bug:"error"},v=[{img:Z,name:"John Doe"},{img:Z,name:"Jane Smith"},{img:Z,name:"Robert Johnson"},{img:Z,name:"Lucy Brown"},{img:Z,name:"Mike White"},{img:Z,name:"Anna Black"}],V=w();return(T,g)=>{const S=He,K=ge,W=Me,D=Re,f=ze("IconBtn");return N(),B(Ge,{"model-value":n.isDrawerOpen,width:370,border:"0",class:"kanban-navigation-drawer","data-allow-mismatch":"",location:"end",temporary:"","onUpdate:modelValue":s},{default:h(()=>[u(S,{title:"Edit Task",onCancel:g[0]||(g[0]=b=>T.$emit("update:isDrawerOpen",!1))}),u(Qe),u(m(je),{options:{wheelPropagation:!1},style:{"block-size":"calc(100vh - 4rem)"}},{default:h(()=>[m(r)?(N(),B(m(ne),{key:0,ref_key:"refEditTaskForm",ref:o,onSubmit:Y(d,["prevent"])},{default:h(()=>[u(be,null,{default:h(()=>[u(et,null,{default:h(()=>[u(U,{cols:"12"},{default:h(()=>[u(K,{modelValue:m(r).title,"onUpdate:modelValue":g[1]||(g[1]=b=>m(r).title=b),rules:["requiredValidator"in T?T.requiredValidator:m(ee)],label:"Title"},null,8,["modelValue","rules"])]),_:1}),u(U,{cols:"12"},{default:h(()=>[u(W,{modelValue:m(r).dueDate,"onUpdate:modelValue":g[2]||(g[2]=b=>m(r).dueDate=b),config:m(y),label:"Due date"},null,8,["modelValue","config"])]),_:1}),u(U,{cols:"12"},{default:h(()=>[u(D,{modelValue:m(r).labels,"onUpdate:modelValue":g[3]||(g[3]=b=>m(r).labels=b),items:l,eager:"",label:"Label",multiple:""},{chip:h(({item:b})=>[u(he,{color:I[b.raw],closable:""},{default:h(()=>[A(F(b.raw),1)]),_:2},1032,["color"])]),_:1},8,["modelValue"])]),_:1}),u(U,{cols:"12"},{default:h(()=>[g[12]||(g[12]=x("p",{class:"mb-1 text-body-2 text-high-emphasis",style:{"line-height":"15px"}}," Assigned ",-1)),x("div",null,[u(tt,{modelValue:m(r).members,"onUpdate:modelValue":g[4]||(g[4]=b=>m(r).members=b),items:v,"menu-props":{offset:10},"item-title":"name","item-value":"name",multiple:"","return-object":"",variant:"plain"},{selection:h(({item:b})=>[u(ve,{size:"26"},{default:h(()=>[u(ie,{src:b.raw.img},null,8,["src"]),u(De,{activator:"parent"},{default:h(()=>[A(F(b.raw.name),1)]),_:2},1024)]),_:2},1024)]),"prepend-inner":h(()=>[u(f,{size:"26",variant:"tonal"},{default:h(()=>[u(C,{icon:"bx-plus",size:"20"})]),_:1})]),_:1},8,["modelValue"])])]),_:1,__:[12]}),u(U,{cols:"12"},{default:h(()=>[u(nt,{modelValue:m(V),"onUpdate:modelValue":g[5]||(g[5]=b=>q(V)?V.value=b:null),clearable:"",label:"No file chosen",multiple:"","prepend-inner-icon":"",variant:"outlined"},{append:h(()=>[u(R,{variant:"tonal"},{default:h(()=>g[13]||(g[13]=[A(" Choose ")])),_:1,__:[13]})]),_:1},8,["modelValue"])]),_:1}),u(U,{cols:"12"},{default:h(()=>[g[14]||(g[14]=x("p",{class:"text-body-2 text-high-emphasis mb-1",style:{"line-height":"15px"}}," COMMENT ",-1)),x("div",ln,[u(m(qe),{editor:m(c)},null,8,["editor"]),m(c)?(N(),_("div",sn,[u(C,{color:m(c).isActive("bold")?"primary":"secondary",icon:"bx-bold",size:"20",onClick:g[6]||(g[6]=b=>m(c).chain().focus().toggleBold().run())},null,8,["color"]),u(C,{color:m(c).isActive("underline")?"primary":"secondary",icon:"bx-underline",size:"20",onClick:g[7]||(g[7]=b=>m(c).commands.toggleUnderline())},null,8,["color"]),u(C,{color:m(c).isActive("italic")?"primary":"secondary",icon:"bx-italic",size:"20",onClick:g[8]||(g[8]=b=>m(c).chain().focus().toggleItalic().run())},null,8,["color"]),u(C,{color:m(c).isActive({textAlign:"left"})?"primary":"secondary",icon:"bx-align-left",size:"20",onClick:g[9]||(g[9]=b=>m(c).chain().focus().setTextAlign("left").run())},null,8,["color"]),u(C,{color:m(c).isActive({textAlign:"center"})?"primary":"secondary",icon:"bx-align-middle",size:"20",onClick:g[10]||(g[10]=b=>m(c).chain().focus().setTextAlign("center").run())},null,8,["color"]),u(C,{color:m(c).isActive({textAlign:"right"})?"primary":"secondary",icon:"bx-align-right",size:"20",onClick:g[11]||(g[11]=b=>m(c).chain().focus().setTextAlign("right").run())},null,8,["color"])])):P("",!0)])]),_:1,__:[14]}),u(U,{cols:"12"},{default:h(()=>[u(R,{class:"me-4",type:"submit"},{default:h(()=>g[15]||(g[15]=[A(" Update ")])),_:1,__:[15]}),u(R,{color:"error",variant:"tonal",onClick:p},{default:h(()=>g[16]||(g[16]=[A(" Delete ")])),_:1,__:[16]})]),_:1})]),_:1})]),_:1})]),_:1},512)):P("",!0)]),_:1})]),_:1},8,["model-value"])}}}),cn={class:"d-flex align-start gap-2"},un={key:0,class:"d-flex flex-wrap gap-2"},fn={class:"text-base text-high-emphasis mb-0"},mn={class:"task-footer d-flex align-center flex-wrap justify-space-between"},pn={key:0,class:"d-flex align-center gap-4"},gn={key:0},bn={class:"text-body-1 d-inline-block"},hn={key:1},vn={class:"text-body-1 d-inline-block"},Dn={key:1,class:"v-avatar-group"},yn=j({__name:"KanbanCard",props:{item:{},boardId:{},boardName:{}},emits:["deleteKanbanItem"],setup(e,{emit:t}){const n=e,a=t,o={UX:"success",Image:"warning","Code Review":"info",Dashboard:"primary",Bug:"error"},l=[{title:"Copy Task link",href:"#"},{title:"Duplicate Task",href:"#"},{title:"Delete",onClick:()=>{a("deleteKanbanItem",{item:n.item,boardId:n.boardId,boardName:n.boardName})}}];return(r,s)=>r.item?(N(),B(rt,{key:0,ripple:!1,link:!1,class:"kanban-card position-relative"},{default:h(()=>[u(be,{class:"d-flex flex-column gap-2"},{default:h(()=>[x("div",cn,[r.item.labels&&r.item.labels.length?(N(),_("div",un,[(N(!0),_(J,null,te(r.item.labels,d=>(N(),B(he,{key:d,size:"small",color:o[d]},{default:h(()=>[A(F(d),1)]),_:2},1032,["color"]))),128))])):P("",!0),u(lt),u(st,null,{activator:h(({props:d,isActive:p})=>[u(C,Fe(d,{icon:"bx-dots-vertical-rounded",class:"position-absolute more-options",style:[{"inset-block-start":"16px","inset-inline-end":"10px"},p?"opacity: 1":""],size:"20",onClick:s[0]||(s[0]=Y(()=>{},["stop"]))}),null,16,["style"])]),default:h(()=>[u(it,{items:l,"item-props":""})]),_:1})]),r.item.image&&r.item.image.length?(N(),B(ie,{key:0,src:r.item.image,class:"rounded"},null,8,["src"])):P("",!0),x("p",fn,F(r.item.title),1),x("div",mn,[r.item.attachments||r.item.commentsCount?(N(),_("div",pn,[r.item.attachments?(N(),_("div",gn,[u(C,{size:"20",icon:"bx-paperclip",class:"me-1"}),x("span",bn,F(r.item.attachments),1)])):P("",!0),r.item.commentsCount?(N(),_("div",hn,[u(C,{size:"20",icon:"bx-chat",class:"me-1"}),x("span",vn,F(r.item.commentsCount),1)])):P("",!0)])):P("",!0),r.item.members&&r.item.members.length?(N(),_("div",Dn,[(N(!0),_(J,null,te(r.item.members,d=>(N(),B(ve,{key:d.name,size:"30"},{default:h(()=>[u(ie,{src:d.img},null,8,["src"]),u(De,{activator:"parent"},{default:h(()=>[A(F(d.name),1)]),_:2},1024)]),_:2},1024))),128))])):P("",!0)])]),_:1})]),_:1})):P("",!0)}}),Nn=dt(yn,[["__scopeId","data-v-e55c42d3"]]),xn={class:"kanban-board"},wn={class:"kanban-board-header pb-4"},kn={key:1,class:"d-flex align-center justify-space-between"},Tn={class:"text-h5 text-truncate"},In={class:"d-flex align-center"},Vn={class:"add-new-form"},Cn={class:"mb-4"},_n={class:"d-flex gap-4 flex-wrap"},Pn=j({__name:"KanbanItems",props:{kanbanIds:{},groupName:{},boardName:{},boardId:{},kanbanData:{}},emits:["renameBoard","deleteBoard","addNewItem","editItem","updateItemsState","deleteItem"],setup(e,{emit:t}){const n=e,a=t,o=w(),l=w(n.boardName),r=w(n.kanbanIds),s=w(!1),d=w(!1),p=w(),c=w(""),y=w(),I=[{title:"Rename",prependIcon:"bx-edit",onClick:()=>{d.value=!0}},{title:"Delete",prependIcon:"bx-trash",onClick:()=>a("deleteBoard",n.boardId)}],v=()=>{var D;(D=y.value)==null||D.validate().then(f=>{f.valid&&(a("renameBoard",{oldName:n.boardName,newName:l.value,boardId:n.boardId}),d.value=!1)})},V=()=>{var D;(D=p.value)==null||D.validate().then(f=>{f.valid&&(a("addNewItem",{itemTitle:c.value,boardName:n.boardName,boardId:n.boardId}),s.value=!1,c.value="")})};Oe({parent:o,values:r,group:n.groupName,draggable:D=>D.classList.contains("kanban-card"),plugins:[Te()],performTransfer:(D,f)=>{Se(D,f),a("updateItemsState",{boardId:n.boardId,ids:r.value})},handleEnd:D=>{Ee(D),a("updateItemsState",{boardId:n.boardId,ids:r.value})}}),X(()=>n,()=>{r.value=n.kanbanIds},{immediate:!0,deep:!0});const T=D=>n.kanbanData.items.find(f=>f.id===D),g=D=>{a("deleteItem",D)},S=()=>{var D;s.value=!1,(D=p.value)==null||D.reset()};se(p,S),se(y,()=>{d.value=!1});const K=()=>{d.value=!1,l.value=n.boardName},W=D=>{D.key==="Enter"&&!D.shiftKey&&V()};return(D,f)=>{const b=ot,le=at;return N(),_("div",xn,[x("div",wn,[m(d)?(N(),B(m(ne),{key:0,ref_key:"refKanbanBoardTitle",ref:y,onSubmit:Y(v,["prevent"])},{default:h(()=>[u(ct,{modelValue:m(l),"onUpdate:modelValue":f[0]||(f[0]=k=>q(l)?l.value=k:null),autofocus:"",variant:"underlined",rules:["requiredValidator"in D?D.requiredValidator:m(ee)],"hide-details":"",class:"border-0",onKeydown:Q(K,["esc"])},{"append-inner":h(()=>[u(C,{size:"20",color:"success",icon:"bx-check",class:"me-1",onClick:v}),u(C,{size:"20",variant:"text",color:"error",icon:"bx-x",class:"flip-in-rtl",onClick:K})]),_:1},8,["modelValue","rules"])]),_:1},512)):(N(),_("div",kn,[x("h5",Tn,F(D.boardName),1),x("div",In,[u(C,{class:"drag-handler",size:"20",icon:"bx-move"}),u(b,{size:"small","icon-size":"20","menu-list":I,"item-props":"",class:"text-high-emphasis"})])]))]),m(r)?(N(),_("div",{key:0,ref_key:"refKanbanBoard",ref:o,class:Ke(["kanban-board-drop-zone rounded d-flex flex-column gap-4",m(r).length?"mb-4":""])},[(N(!0),_(J,null,te(m(r),k=>(N(),B(Nn,{key:k,item:T(k),"board-id":n.boardId,"board-name":n.boardName,onDeleteKanbanItem:g,onClick:On=>a("editItem",{item:T(k),boardId:n.boardId,boardName:n.boardName})},null,8,["item","board-id","board-name","onClick"]))),128)),x("div",Vn,[x("div",{class:"text-body-1 text-high-emphasis cursor-pointer d-flex align-center gap-1 ms-4",onClick:f[1]||(f[1]=k=>s.value=!m(s))},[u(C,{size:"15",icon:"bx-plus"}),f[3]||(f[3]=x("span",null,"Add New Item",-1))]),m(s)?(N(),B(m(ne),{key:0,ref_key:"refForm",ref:p,class:"mt-4","validate-on":"submit",onSubmit:Y(V,["prevent"])},{default:h(()=>[x("div",Cn,[u(le,{modelValue:m(c),"onUpdate:modelValue":f[2]||(f[2]=k=>q(c)?c.value=k:null),rules:["requiredValidator"in D?D.requiredValidator:m(ee)],placeholder:"Add Content",autofocus:"",rows:"2",onKeydown:[Q(W,["enter"]),Q(S,["esc"])]},null,8,["modelValue","rules"])]),x("div",_n,[u(R,{size:"small",type:"submit"},{default:h(()=>f[4]||(f[4]=[A(" Add ")])),_:1,__:[4]}),u(R,{size:"small",variant:"tonal",color:"secondary",onClick:S},{default:h(()=>f[5]||(f[5]=[A(" Cancel ")])),_:1,__:[5]})])]),_:1},512)):P("",!0)])],2)):P("",!0)])}}}),En={class:"kanban-main-wrapper d-flex gap-4 h-100"},Bn={class:"add-new-form text-no-wrap",style:{"inline-size":"10rem"}},An={class:"mb-4"},$n={class:"d-flex gap-3"},Sn=j({__name:"KanbanBoard",props:{kanbanData:{},groupName:{default:"kanban"}},emits:["addNewBoard","renameBoard","deleteBoard","addNewItem","editItem","deleteItem","updateItemsState","updateBoardState"],setup(e,{emit:t}){const n=e,a=t,o=w(),l=w(n.kanbanData.boards),r=w(!1),s=w(!1),d=w(),p=w(""),c=w(),y=()=>{var f;(f=d.value)==null||f.validate().then(b=>{b.valid&&(a("addNewBoard",p.value),s.value=!1,p.value="")})},I=f=>{a("deleteBoard",f)},v=f=>{a("renameBoard",f)},V=f=>{a("addNewItem",f)},T=f=>{f&&(c.value=f,r.value=!0)},g=f=>{a("updateItemsState",f)};Oe({parent:o,values:l,dragHandle:".drag-handler",plugins:[Te()]}),X(n,()=>{l.value=n.kanbanData.boards,ue(o.value)},{deep:!0});const S=f=>{a("editItem",f)},K=f=>{a("deleteItem",f)};X(l,()=>{const f=l.value.map(b=>b.id);a("updateBoardState",f)},{deep:!0});const W=()=>n.kanbanData.boards.some(f=>p.value&&f.title.toLowerCase()===p.value.toLowerCase())?"Board title already exists":!0,D=()=>{var f;s.value=!1,(f=d.value)==null||f.reset()};return se(d,D),(f,b)=>{const le=ge;return N(),_(J,null,[x("div",En,[x("div",{ref_key:"kanbanWrapper",ref:o,class:"d-flex ga-6 pt-1"},[(N(!0),_(J,null,te(m(l),k=>(N(),B(Pn,{key:k.id,"group-name":f.groupName,"kanban-ids":k.itemsIds,"board-name":k.title,"board-id":k.id,"kanban-items":f.kanbanData.items,"kanban-data":f.kanbanData,onDeleteBoard:I,onRenameBoard:v,onAddNewItem:V,onEditItem:T,onUpdateItemsState:g,onDeleteItem:K},null,8,["group-name","kanban-ids","board-name","board-id","kanban-items","kanban-data"]))),128))],512),x("div",Bn,[x("h5",{class:"text-h5 cursor-pointer d-flex align-center gap-2",onClick:b[0]||(b[0]=k=>s.value=!m(s))},[u(C,{size:"18",icon:"bx-plus"}),b[3]||(b[3]=x("span",null,"Add New",-1))]),m(s)?(N(),B(m(ne),{key:0,ref_key:"refAddNewBoard",ref:d,class:"mt-4","validate-on":"submit",onSubmit:Y(y,["prevent"])},{default:h(()=>[x("div",An,[u(le,{modelValue:m(p),"onUpdate:modelValue":b[1]||(b[1]=k=>q(p)?p.value=k:null),rules:["requiredValidator"in f?f.requiredValidator:m(ee),W],autofocus:"",placeholder:"Add Board Title",onKeydown:Q(D,["esc"])},null,8,["modelValue","rules"])]),x("div",$n,[u(R,{size:"small",type:"submit"},{default:h(()=>b[4]||(b[4]=[A(" Add ")])),_:1,__:[4]}),u(R,{size:"small",variant:"tonal",color:"secondary",type:"reset",onClick:D},{default:h(()=>b[5]||(b[5]=[A(" Cancel ")])),_:1,__:[5]})])]),_:1},512)):P("",!0)])]),u(dn,{"is-drawer-open":m(r),"onUpdate:isDrawerOpen":b[2]||(b[2]=k=>q(r)?r.value=k:null),"kanban-item":m(c),"onUpdate:kanbanItem":S,onDeleteKanbanItem:K},null,8,["is-drawer-open","kanban-item"])],64)}}}),$a=j({__name:"index",async setup(e){let t,n;const{data:a,execute:o}=([t,n]=Ue(()=>ut("/apps/kanban")),t=await t,n(),t),l=async v=>{await z("/apps/kanban/board/add",{method:"POST",body:{title:v}}),o()},r=async v=>{await z(`/apps/kanban/board/${v}`,{method:"DELETE"}),o()},s=async v=>{await z("/apps/kanban/board/rename",{method:"PUT",body:v}),o()},d=async v=>{await z("/apps/kanban/item/add",{method:"POST",body:v}),o()},p=async v=>{await z("/apps/kanban/item/update",{method:"PUT",body:v}),o()},c=async v=>{v.item&&v.item.id&&(await z(`/apps/kanban/item/${v.item.id}`,{method:"DELETE",body:v}),o())},y=async v=>{await z("/apps/kanban/item/state-update",{method:"PUT",body:v})},I=async v=>{await z("/apps/kanban/board/state-update",{method:"PUT",body:v})};return(v,V)=>m(a)?(N(),B(Sn,{key:0,"kanban-data":m(a),onAddNewBoard:l,onDeleteBoard:r,onRenameBoard:s,onAddNewItem:d,onEditItem:p,onDeleteItem:c,onUpdateItemsState:y,onUpdateBoardState:I},null,8,["kanban-data"])):P("",!0)}});export{$a as default};
