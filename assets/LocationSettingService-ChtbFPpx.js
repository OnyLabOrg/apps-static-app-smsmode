var d=Object.defineProperty;var u=(a,t,e)=>t in a?d(a,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):a[t]=e;var i=(a,t,e)=>u(a,typeof t!="symbol"?t+"":t,e);import{d as g,h as l,b as c}from"./Http-CDqqPxIa.js";import{$ as h}from"./api-C5XqUV6y.js";class v{constructor(t,e,o){i(this,"name");i(this,"loading");i(this,"loader");i(this,"locationStore");this.name=t,this.loading=e??{value:!1},this.loader=o,this.locationStore=g()}start(){this.locationStore.onCurrentLocationChange(this.loadSetting.bind(this))}saveSetting(t){return new Promise((e,o)=>{const s=this.loading,r=this.locationStore.getCurrentLocation;if(typeof(r==null?void 0:r.id)!="string")return e();s.value=!0,h(`location/setting/value?locationReference=${r.id}`,{method:"PUT",body:{name:this.name,type:"object",value:t},onResponseError({response:n}){s.value=!1,l(n),o(new Error(n._data.message??"Request failed"))}}).then(n=>{s.value=!1,e()}).catch(n=>{s.value=!1,c(n),o(n)})})}loadSetting(){const t=this.loading,e=this.locationStore.getCurrentLocation;typeof(e==null?void 0:e.id)=="string"&&(t.value=!0,h(`location/setting/value?locationReference=${e.id}&name=${this.name}`,{method:"GET",onResponseError({response:o}){t.value=!1,l(o)}}).then(o=>{t.value=!1,this.loader(o)}).catch(o=>{t.value=!1,c(o)}))}isReady(){var t;return((t=this.locationStore)==null?void 0:t.getCurrentLocation)!==void 0}stop(){this.locationStore.offCurrentLocationChange(this.loadSetting.bind(this))}}export{v as L};
