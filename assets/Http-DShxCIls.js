import{bg as l,co as g,cp as h,cq as C,b3 as i}from"./index-DfJhTF3D.js";import{m as d}from"./mitt-DJ65BbbF.js";import{u as L,a as v}from"./location-Cc6Lhsvp.js";import{u as w}from"./alert-BOXdw994.js";import{$ as u}from"./TranslationUtil-Bbldp_kP.js";const m=()=>typeof window.navigator!="object"||typeof window.navigator.onLine!="boolean"?!0:window.navigator.onLine,n=()=>typeof document.hidden=="boolean"?document.hidden:typeof document.msHidden=="boolean"?document.msHidden:typeof document.webkitHidden=="boolean"?document.webkitHidden:!1,r=d(),E=l("userStore",{state:()=>({user:void 0}),getters:{getCurrentUser:t=>t.user},actions:{onCurrentUserChange(t){r.on("update:user",t),t(this.user)},offCurrentUserChange(t){r.off("update:user",t)},setCurrentUser(t){this.user=t,r.emit("update:user",this.user)},reset(){this.user=void 0,r.emit("update:user",this.user)}},persist:!0}),s=d(),y=l("customerListStore",{state:()=>({customerList:void 0,customerLists:void 0}),getters:{getCurrentCustomerList:t=>t.customerList,getCustomerLists:t=>t.customerLists},actions:{onCurrentCustomerListChange(t){s.on("update:customerList",t),t(this.customerList)},offCurrentCustomerListChange(t){s.off("update:customerList",t)},onCustomerListsChange(t){s.on("update:customerLists",t),t(this.customerLists)},offCustomerListsChange(t){s.off("update:customerLists",t)},setCurrentCustomerList(t){this.customerList=t,s.emit("update:customerList",this.customerList)},setCustomerLists(t){this.customerLists=t,s.emit("update:customerLists",this.customerLists)},reset(){this.customerList=void 0,s.emit("update:customerList",this.customerList),this.customerLists=void 0,s.emit("update:customerLists",this.customerLists)}},persist:!0}),o=d(),b=l("catalogStore",{state:()=>({catalog:void 0,catalogs:void 0}),getters:{getCurrentCatalog:t=>t.catalog,getCatalogs:t=>t.catalogs},actions:{onCurrentCatalogChange(t){o.on("update:catalog",t),t(this.catalog)},offCurrentCatalogChange(t){o.off("update:catalog",t)},onCatalogsChange(t){o.on("update:catalogs",t),t(this.catalogs)},offCatalogsChange(t){o.off("update:catalogs",t)},setCurrentCatalog(t){this.catalog=t,o.emit("update:catalog",this.catalog)},setCatalogs(t){this.catalogs=t,o.emit("update:catalogs",this.catalogs)},reset(){this.catalog=void 0,o.emit("update:catalog",this.catalog),this.catalogs=void 0,o.emit("update:catalogs",this.catalogs)}},persist:!0});class f{static info(e,a){g(p=>{p.setExtra("context",Object.assign({isOnline:m(),isHidden:n()},a)),h(e)})}static exception(e){if(n()&&e.message!==void 0&&e.message!==null&&typeof e.message=="string"&&e.message.includes("timeout")||e.message!==void 0&&e.message!==null&&typeof e.message=="string"&&e.message.includes("status code 401"))return!1;g(a=>{a.setExtra("context",{isOnline:m(),isHidden:n()}),C(e)})}}const S=()=>{L().reset(),E().reset(),v().reset(),y().reset(),b().reset()},x=async(t,e)=>{i("jwt",{domain:".apps.onylab.com"}).value=null,i("accessToken").value=null,i("userData").value=null,i("userAbilityRules").value=null,S(),t!==void 0?await t.push("/login"):window.location.href="/",e!==void 0&&e.update([])},c=t=>(w().setAlert({title:t}),t),H=(t,e)=>!m()||typeof t.message=="string"&&t.message.includes("Network Error")?c(u("common.error.offline")):typeof t.message=="string"&&t.message.includes("timeout")?c(u("common.error.timeout")):(f.exception(t),c(u("common.error.default"))),O=async(t,e)=>{if(t.status===401){x().catch(f.exception);return}const a=new Error(t._data.message??"Request failed");return H(a)};export{H as a,y as b,S as c,b as d,O as h,x as l,E as u};
