import{$ as u}from"./TranslationUtil-CuCvAqC-.js";import{b as j,d as A,e as M,h as p,a as f}from"./Http-DBRaVIKk.js";import{$ as L}from"./api-7bxxJisY.js";import{V as y}from"./VSelect-DC24zlSS.js";import{d as z,r as g,G as H,c as J,F as K,g as V,l as S,f as E,m as n,t as k,v as w,o as b}from"./index-9shWMfiu.js";const Y=z({__name:"AppSelectContext",props:{enableLocations:{type:Boolean,default:()=>!1},enableCustomerLists:{type:Boolean,default:()=>!1},enableCatalogs:{type:Boolean,default:()=>!1}},setup(F){const h=F,R=g(h.enableLocations),B=g(h.enableCustomerLists),G=g(h.enableCatalogs),l=j(),s=A(),a=M(),i=g(),d=g(),r=g();i.value=l.getCurrentLocation,d.value=s.getCurrentCustomerList,r.value=a.getCurrentCatalog;const C=e=>{var o;typeof e=="string"&&(e=((o=s.getCustomerLists)==null?void 0:o.find(t=>t.id===e))??null),e!==null&&(s.setCurrentCustomerList(e),d.value=s.getCurrentCustomerList)},m=e=>{var o;if(typeof e=="string"&&(e=((o=a.getCatalogs)==null?void 0:o.find(t=>t.id===e))??null),e!==null){if(e.data!==void 0){a.setCurrentCatalog(e),r.value=a.getCurrentCatalog;return}L(`catalog?catalogId=${e.id}`,{method:"GET",onResponseError({response:t}){a.setCurrentCatalog(void 0),p(t)}}).then(t=>{a.setCurrentCatalog(t.catalog),r.value=a.getCurrentCatalog,e.data=t.catalog.data}).catch(t=>{a.setCurrentCatalog(void 0),f(t)})}},T=()=>{var e,o;G.value&&(a.getCatalogs===void 0?(a.setCatalogs(void 0),L(`catalogs?locationId=${(e=l.getCurrentLocation)==null?void 0:e.id}`,{method:"GET",onResponseError({response:t}){p(t)}}).then(t=>{var c;a.setCatalogs(t.catalogs),((c=a.getCatalogs)==null?void 0:c.length)===1&&m(a.getCatalogs[0])}).catch(t=>{f(t)})):a.getCurrentCatalog!==void 0?m(a.getCurrentCatalog):((o=a.getCatalogs)==null?void 0:o.length)===1&&m(a.getCatalogs[0]))},D=()=>{var e,o;B.value&&(s.getCustomerLists===void 0?(s.setCustomerLists(void 0),L(`customers/list?locationId=${(e=l.getCurrentLocation)==null?void 0:e.id}`,{method:"GET",onResponseError({response:t}){p(t)}}).then(t=>{var c;s.setCustomerLists(t.lists),((c=s.getCustomerLists)==null?void 0:c.length)===1&&C(s.getCustomerLists[0])}).catch(t=>{f(t)})):s.getCurrentCustomerList!==void 0?C(s.getCurrentCustomerList):((o=s.getCustomerLists)==null?void 0:o.length)===1&&C(s.getCustomerLists[0]))},v=e=>{var o;typeof e=="string"&&(e=((o=l.getLocations)==null?void 0:o.find(t=>t.id===e))??null),e!==null&&(e!==l.getCurrentLocation?(l.setCurrentLocation(e),i.value=l.getCurrentLocation,U(),q()):(D(),T()))},I=()=>{l.setLocations(void 0),L("locations",{method:"GET",onResponseError({response:e}){p(e)}}).then(e=>{var o;l.setLocations(e.locations),((o=l.getLocations)==null?void 0:o.length)===1&&v(l.getLocations[0])}).catch(e=>{f(e)})},N=()=>{i.value!==void 0&&(i.value=void 0),l.reset(),I()},U=()=>{d.value!==void 0&&(d.value=void 0),s.reset(),D()},q=()=>{r.value!==void 0&&(r.value=void 0),a.reset(),T()},$=e=>typeof e!="object"||e===null?e:`${e.name} (${e.id})`;return H(()=>{var e;R.value&&(l.getLocations===void 0?I():l.getCurrentLocation!==void 0?v(l.getCurrentLocation):((e=l.getLocations)==null?void 0:e.length)===1&&v(l.getLocations[0]))}),(e,o)=>(b(),J(K,null,[R.value?(b(),V(y,{key:0,modelValue:i.value,"onUpdate:modelValue":[o[0]||(o[0]=t=>i.value=t),v],disabled:n(l).getLocations===void 0,"item-title":$,items:n(l).getLocations,label:("$t"in e?e.$t:n(u))("page.order.add.button.location.label"),loading:n(l).getLocations===void 0,placeholder:("$t"in e?e.$t:n(u))("page.order.add.button.location.placeholder"),clearable:"","item-value":"id","no-data-text":"common.component.noData",style:{width:"200px"},variant:"underlined","onClick:clear":N},{selection:E(({item:t})=>[k(w(t.raw.name),1)]),_:1},8,["modelValue","disabled","items","label","loading","placeholder"])):S("",!0),B.value?(b(),V(y,{key:1,modelValue:d.value,"onUpdate:modelValue":[o[1]||(o[1]=t=>d.value=t),C],disabled:n(s).getCustomerLists===void 0,"item-title":$,items:n(s).getCustomerLists,label:("$t"in e?e.$t:n(u))("page.order.add.button.customerList.label"),loading:n(s).getCustomerLists===void 0,placeholder:("$t"in e?e.$t:n(u))("page.order.add.button.customerList.placeholder"),clearable:"","item-value":"id","no-data-text":"common.component.noData",style:{width:"200px"},variant:"underlined","onClick:clear":U},{selection:E(({item:t})=>[k(w(t.raw.name),1)]),_:1},8,["modelValue","disabled","items","label","loading","placeholder"])):S("",!0),G.value?(b(),V(y,{key:2,modelValue:r.value,"onUpdate:modelValue":[o[2]||(o[2]=t=>r.value=t),m],disabled:n(a).getCatalogs===void 0,"item-title":$,items:n(a).getCatalogs,label:("$t"in e?e.$t:n(u))("page.order.add.button.catalog.label"),loading:n(a).getCatalogs===void 0,placeholder:("$t"in e?e.$t:n(u))("page.order.add.button.catalog.placeholder"),clearable:"","item-value":"id","no-data-text":"common.component.noData",style:{width:"200px"},variant:"underlined","onClick:clear":q},{selection:E(({item:t})=>[k(w(t.raw.name),1)]),_:1},8,["modelValue","disabled","items","label","loading","placeholder"])):S("",!0)],64))}});export{Y as _};
